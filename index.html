<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Learning Dashboard</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
<style>
:root {
  /* ‚îÄ‚îÄ Dark mode (default) ‚îÄ‚îÄ */
  --bg: #06080f;
  --surface: #0b1120;
  --card: #0f1929;
  --card-hover: #162038;
  --border: rgba(140,190,255,0.09);
  --border-bright: rgba(140,190,255,0.22);
  --header-bg: rgba(6,8,15,0.92);

  /* Accent palette ‚Äì vivid */
  --teal: #00e5b8;
  --teal-dim: rgba(0,229,184,0.12);
  --teal-glow: rgba(0,229,184,0.30);
  --amber: #ffb020;
  --amber-dim: rgba(255,176,32,0.12);
  --blue: #4f9eff;
  --blue-dim: rgba(79,158,255,0.12);
  --violet: #b97fff;
  --violet-dim: rgba(185,127,255,0.12);
  --pink: #ff6eb4;
  --pink-dim: rgba(255,110,180,0.12);
  --red: #ff6b6b;
  --red-dim: rgba(255,107,107,0.12);
  --lime: #a3e635;
  --lime-dim: rgba(163,230,53,0.12);

  /* Phase accent colours */
  --phase1: #4f9eff;
  --phase2: #b97fff;
  --phase3: #ff6eb4;
  --phase4: #00e5b8;

  /* Text */
  --text: #cce0f5;
  --text-muted: #4e6a8a;
  --text-dim: #7a9dbc;
  --text-heading: #ffffff;

  --font-d: 'Syne', sans-serif;
  --font-m: 'DM Mono', monospace;
  --radius: 10px;
  --tab-h: 48px;
  --theme-transition: background 0.25s ease, color 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease;
}

/* ‚îÄ‚îÄ Light mode ‚îÄ‚îÄ */
body.light {
  --bg: #f0f4ff;
  --surface: #ffffff;
  --card: #ffffff;
  --card-hover: #f5f8ff;
  --border: rgba(60,100,180,0.10);
  --border-bright: rgba(60,100,180,0.22);
  --header-bg: rgba(240,244,255,0.95);

  --teal: #00a884;
  --teal-dim: rgba(0,168,132,0.10);
  --teal-glow: rgba(0,168,132,0.22);
  --amber: #d97706;
  --amber-dim: rgba(217,119,6,0.10);
  --blue: #2563eb;
  --blue-dim: rgba(37,99,235,0.10);
  --violet: #7c3aed;
  --violet-dim: rgba(124,58,237,0.10);
  --pink: #db2777;
  --pink-dim: rgba(219,39,119,0.10);
  --red: #dc2626;
  --red-dim: rgba(220,38,38,0.10);
  --lime: #65a30d;
  --lime-dim: rgba(101,163,13,0.10);

  --phase1: #2563eb;
  --phase2: #7c3aed;
  --phase3: #db2777;
  --phase4: #00a884;

  --text: #1e3a5f;
  --text-muted: #6b8aaa;
  --text-dim: #4a6a8a;
  --text-heading: #0f1e33;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: var(--font-m);
  font-size: 13px;
  min-height: 100vh;
  overflow-x: hidden;
  transition: var(--theme-transition);
}

/* Noise texture overlay */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
  pointer-events: none;
  z-index: 0;
  transition: opacity 0.25s;
}
body.light::before { opacity: 0.4; }

/* ‚îÄ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ */
#header {
  position: sticky; top: 0; z-index: 100;
  background: var(--header-bg);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--border);
  padding: 0 28px;
  display: flex; align-items: center; gap: 20px;
  height: 60px;
  transition: var(--theme-transition);
}
.logo {
  font-family: var(--font-d);
  font-size: 15px; font-weight: 800;
  letter-spacing: -0.3px;
  color: var(--text-heading);
  white-space: nowrap;
  display: flex; align-items: center; gap: 8px;
}
.logo-dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: var(--teal);
  box-shadow: 0 0 8px var(--teal-glow);
  animation: pulse 2.5s ease-in-out infinite;
}
@keyframes pulse {
  0%,100% { opacity:1; transform:scale(1); }
  50% { opacity:0.6; transform:scale(1.3); }
}

/* Theme toggle */
.theme-toggle {
  width: 38px; height: 38px; border-radius: 9px;
  display: flex; align-items: center; justify-content: center;
  background: var(--card); border: 1px solid var(--border);
  cursor: pointer; font-size: 17px; line-height: 1;
  transition: all 0.2s; flex-shrink: 0;
  color: var(--text-muted);
}
.theme-toggle:hover { border-color: var(--border-bright); color: var(--text); background: var(--card-hover); }

/* ‚îÄ‚îÄ‚îÄ TABS ‚îÄ‚îÄ‚îÄ */
#tabs {
  display: flex; align-items: center; gap: 2px;
  padding: 0 28px;
  height: var(--tab-h);
  border-bottom: 1px solid var(--border);
  background: var(--surface);
  transition: var(--theme-transition);
}
.tab-btn {
  padding: 0 18px;
  height: var(--tab-h);
  background: none; border: none; cursor: pointer;
  font-family: var(--font-d);
  font-size: 12px; font-weight: 600;
  letter-spacing: 0.06em; text-transform: uppercase;
  color: var(--text-muted);
  border-bottom: 2px solid transparent;
  margin-bottom: -1px;
  transition: color 0.15s, border-color 0.15s;
  display: flex; align-items: center; gap: 8px;
}
.tab-btn:hover { color: var(--text); }
.tab-btn.active { color: var(--teal); border-bottom-color: var(--teal); }
.tab-count {
  font-size: 10px; padding: 1px 6px; border-radius: 8px;
  background: var(--card); color: var(--text-dim);
  transition: var(--theme-transition);
}

.add-btn {
  margin-left: auto;
  display: flex; align-items: center; gap: 7px;
  padding: 8px 16px;
  background: var(--teal-dim);
  border: 1px solid rgba(0,212,170,0.3);
  border-radius: 7px; cursor: pointer;
  font-family: var(--font-d); font-size: 12px; font-weight: 700;
  letter-spacing: 0.04em; color: var(--teal);
  transition: all 0.2s;
}
.add-btn:hover { background: var(--teal); color: #fff; border-color: var(--teal); }
.add-btn svg { width: 14px; height: 14px; }

/* ‚îÄ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ‚îÄ */
#main { padding: 28px; max-width: 1300px; margin: 0 auto; position: relative; z-index: 1; }

.view { display: none; }
.view.active { display: block; animation: fadeIn 0.25s ease; }
@keyframes fadeIn { from { opacity:0; transform:translateY(6px); } to { opacity:1; transform:none; } }

/* ‚îÄ‚îÄ‚îÄ DASHBOARD VIEW ‚îÄ‚îÄ‚îÄ */
.phase-section { margin-bottom: 40px; }
.phase-header {
  display: flex; align-items: center; gap: 14px;
  margin-bottom: 16px;
}
.phase-num {
  font-family: var(--font-d); font-size: 10px; font-weight: 800;
  letter-spacing: 0.15em; text-transform: uppercase;
  padding: 4px 12px; border-radius: 20px;
  border: none;
}
.phase-num-1 { background: rgba(79,158,255,0.18); color: var(--phase1); box-shadow: 0 0 12px rgba(79,158,255,0.15); }
.phase-num-2 { background: rgba(185,127,255,0.18); color: var(--phase2); box-shadow: 0 0 12px rgba(185,127,255,0.15); }
.phase-num-3 { background: rgba(255,110,180,0.18); color: var(--phase3); box-shadow: 0 0 12px rgba(255,110,180,0.15); }
.phase-num-4 { background: rgba(0,229,184,0.18); color: var(--phase4); box-shadow: 0 0 12px rgba(0,229,184,0.15); }
.phase-name {
  font-family: var(--font-d); font-size: 15px; font-weight: 700;
  color: var(--text-heading);
}
.phase-rule { flex: 1; height: 1px; background: var(--border); }
.phase-prog {
  font-size: 11px; color: var(--text-muted); font-family: var(--font-m);
}

.cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 14px;
}

/* ‚îÄ‚îÄ‚îÄ COURSE CARD ‚îÄ‚îÄ‚îÄ */
.course-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  transition: border-color 0.2s, transform 0.15s, box-shadow 0.2s, background 0.25s;
  cursor: pointer;
  position: relative;
}
/* Thick coloured top bar */
.course-card::before {
  content: ''; position: absolute;
  top: 0; left: 0; right: 0; height: 3px;
}
.course-card.status-completed { border-color: rgba(0,229,184,0.20); }
.course-card.status-completed::before { background: linear-gradient(90deg, var(--teal), #00b8ff); }

.course-card.status-in-progress { border-color: rgba(255,176,32,0.20); }
.course-card.status-in-progress::before { background: linear-gradient(90deg, var(--amber), #ff8c42); }

.course-card.status-not-started { border-color: rgba(79,158,255,0.15); }
.course-card.status-not-started::before { background: linear-gradient(90deg, var(--blue), var(--violet)); }

.course-card.status-recommended { border-color: rgba(185,127,255,0.20); border-style: solid; }
.course-card.status-recommended::before { background: linear-gradient(90deg, var(--violet), var(--pink)); }

/* Subtle tinted glow behind each card */
.course-card.status-completed { box-shadow: 0 2px 12px rgba(0,229,184,0.06); }
.course-card.status-in-progress { box-shadow: 0 2px 12px rgba(255,176,32,0.06); }
.course-card.status-not-started { box-shadow: 0 2px 12px rgba(79,158,255,0.04); }
.course-card.status-recommended { box-shadow: 0 2px 12px rgba(185,127,255,0.06); }

.course-card:hover { transform: translateY(-2px); border-color: var(--border-bright); }
.course-card.status-completed:hover { box-shadow: 0 8px 28px rgba(0,229,184,0.14); }
.course-card.status-in-progress:hover { box-shadow: 0 8px 28px rgba(255,176,32,0.14); }
.course-card.status-not-started:hover { box-shadow: 0 8px 28px rgba(79,158,255,0.12); }
.course-card.status-recommended:hover { box-shadow: 0 8px 28px rgba(185,127,255,0.14); }

.card-top {
  padding: 16px;
  display: flex; gap: 14px; align-items: flex-start;
}

/* Progress ring */
.ring-wrap { flex-shrink: 0; position: relative; width: 52px; height: 52px; cursor: pointer; }
.ring-wrap svg { transform: rotate(-90deg); }
.ring-bg { fill: none; stroke: var(--border); }
.ring-fill { fill: none; stroke-linecap: round; transition: stroke-dashoffset 0.5s ease, stroke 0.3s; }
.ring-label {
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  font-size: 11px; font-weight: 600; font-family: var(--font-d);
  color: var(--text-heading);
}

.card-info { flex: 1; min-width: 0; }
.card-name {
  font-family: var(--font-d); font-size: 14px; font-weight: 700;
  color: var(--text-heading); line-height: 1.3; margin-bottom: 3px;
  display: flex; align-items: flex-start; gap: 6px;
}
.card-name-text { flex: 1; }
.card-name-link {
  flex-shrink: 0;
  display: inline-flex; align-items: center; justify-content: center;
  width: 22px; height: 22px; border-radius: 5px; margin-top: 0px;
  background: var(--blue-dim);
  border: 1px solid rgba(79,158,255,0.3);
  color: var(--blue); font-size: 11px; text-decoration: none;
  transition: all 0.15s; line-height: 1;
}
.card-name-link:hover {
  background: var(--blue); color: #fff; border-color: var(--blue);
  box-shadow: 0 0 10px rgba(79,158,255,0.35);
}
.card-provider { font-size: 11px; color: var(--text-muted); font-style: italic; margin-bottom: 6px; }

.card-badges { display: flex; flex-wrap: wrap; gap: 4px; }
.badge {
  font-size: 9px; letter-spacing: 0.08em; text-transform: uppercase;
  padding: 2px 7px; border-radius: 3px; font-weight: 600;
}
.badge-status { cursor: pointer; user-select: none; transition: opacity 0.15s; }
.badge-status:hover { opacity: 0.7; }
.badge-completed { background: var(--teal-dim); color: var(--teal); border: 1px solid rgba(0,229,184,0.30); }
.badge-in-progress { background: var(--amber-dim); color: var(--amber); border: 1px solid rgba(255,176,32,0.30); }
.badge-not-started { background: var(--blue-dim); color: var(--blue); border: 1px solid rgba(79,158,255,0.28); }
.badge-recommended { background: var(--violet-dim); color: var(--violet); border: 1px dashed rgba(185,127,255,0.35); }
.badge-tag { background: rgba(255,255,255,0.05); color: var(--text-dim); border: 1px solid var(--border); }
body.light .badge-tag { background: rgba(0,0,60,0.06); }
.badge-cost { background: rgba(255,255,255,0.04); color: var(--text-muted); border: 1px solid var(--border); }
body.light .badge-cost { background: rgba(0,0,60,0.04); }

/* Expanded card content */
.card-body { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
.card-body.open { max-height: 800px; overflow-y: auto; }
.card-body-inner {
  padding: 0 16px 16px;
  border-top: 1px solid var(--border);
  margin-top: 8px; padding-top: 14px;
}

.card-desc { color: var(--text-dim); font-size: 12px; line-height: 1.6; margin-bottom: 12px; }

.progress-control { margin-bottom: 12px; }
.prog-label {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 6px; font-size: 11px; color: var(--text-muted);
}
.prog-val { color: var(--text); font-weight: 500; }
input[type="range"] {
  width: 100%; height: 4px; border-radius: 4px; cursor: pointer;
  background: var(--border);
  -webkit-appearance: none; outline: none;
}
body.light input[type="range"] { background: rgba(60,100,180,0.15); }
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none; width: 14px; height: 14px; border-radius: 50%;
  background: var(--teal); cursor: pointer;
  box-shadow: 0 0 6px var(--teal-glow);
  transition: transform 0.1s;
}
input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.2); }

.card-meta {
  display: grid; grid-template-columns: 1fr 1fr; gap: 6px;
  margin-bottom: 12px;
}
.meta-item { font-size: 11px; }
.meta-key { color: var(--text-muted); margin-bottom: 2px; }
.meta-val { color: var(--text); font-weight: 500; }

.card-link {
  display: inline-flex; align-items: center; gap: 6px;
  color: var(--teal); font-size: 11px; text-decoration: none;
  transition: opacity 0.15s; margin-bottom: 10px;
}
.card-link:hover { opacity: 0.7; text-decoration: underline; }

.card-actions { display: flex; gap: 8px; flex-wrap: wrap; }
.btn {
  padding: 7px 14px; border-radius: 6px; border: 1px solid;
  font-family: var(--font-m); font-size: 11px; font-weight: 500;
  cursor: pointer; transition: all 0.15s; letter-spacing: 0.03em;
}
.btn-complete { background: var(--teal-dim); border-color: rgba(0,229,184,0.35); color: var(--teal); }
.btn-complete:hover { background: var(--teal); color: #001a14; border-color: var(--teal); }
.btn-edit { background: var(--blue-dim); border-color: rgba(79,158,255,0.35); color: var(--blue); }
.btn-edit:hover { background: var(--blue); color: #fff; border-color: var(--blue); }
.btn-delete { background: var(--red-dim); border-color: rgba(255,107,107,0.35); color: var(--red); margin-left: auto; }
.btn-delete:hover { background: var(--red); color: #fff; border-color: var(--red); }

/* ‚îÄ‚îÄ‚îÄ TIMELINE VIEW ‚îÄ‚îÄ‚îÄ */
#view-timeline { padding-bottom: 20px; }
.timeline-wrap { overflow-x: auto; }
.tl-header-row {
  display: flex; align-items: center;
  margin-bottom: 8px; gap: 0;
}
.tl-label-col { width: 260px; flex-shrink: 0; font-size: 10px; color: var(--text-muted); padding: 0 12px; letter-spacing: 0.1em; text-transform: uppercase; }
.tl-months { display: flex; flex: 1; }
.tl-month {
  flex: 1; min-width: 80px; text-align: center;
  font-size: 10px; color: var(--text-muted); letter-spacing: 0.06em;
  text-transform: uppercase; padding: 4px 0;
  border-left: 1px solid var(--border);
}
.tl-month.current { color: var(--teal); }

.tl-row {
  display: flex; align-items: center;
  min-height: 44px; border-radius: 6px;
  margin-bottom: 6px;
  transition: background 0.15s;
}
.tl-row:hover { background: rgba(255,255,255,0.03); }

.tl-name-col {
  width: 260px; flex-shrink: 0;
  padding: 8px 12px; font-size: 12px; line-height: 1.3;
}
.tl-course-name { font-family: var(--font-d); font-weight: 600; color: var(--text); }
.tl-course-phase { font-size: 10px; color: var(--text-muted); margin-top: 1px; }

.tl-bars { position: relative; flex: 1; height: 44px; }
.tl-grid-line {
  position: absolute; top: 0; bottom: 0;
  width: 1px; background: var(--border);
}
.tl-today-line {
  position: absolute; top: -4px; bottom: -4px;
  width: 1px; background: var(--amber);
  z-index: 2;
}
.tl-today-line::after {
  content: 'TODAY';
  position: absolute; top: 2px; left: 4px;
  font-size: 8px; color: var(--amber); letter-spacing: 0.1em; font-family: var(--font-m);
}
.tl-bar {
  position: absolute; top: 50%; transform: translateY(-50%);
  height: 22px; border-radius: 4px;
  display: flex; align-items: center; overflow: hidden;
  min-width: 4px;
}
.tl-bar-fill {
  height: 100%; border-radius: 4px 0 0 4px;
  transition: width 0.5s ease;
}
.tl-bar-label {
  position: absolute; left: 8px; right: 4px;
  font-size: 9px; font-weight: 600; font-family: var(--font-d);
  letter-spacing: 0.04em; white-space: nowrap; overflow: hidden;
  text-overflow: ellipsis; pointer-events: none;
}

/* Status colors for timeline */
.tl-bar.status-completed { background: rgba(0,212,170,0.15); }
.tl-bar.status-completed .tl-bar-fill { background: rgba(0,212,170,0.5); }
.tl-bar.status-completed .tl-bar-label { color: var(--teal); }

.tl-bar.status-in-progress { background: rgba(245,158,11,0.15); }
.tl-bar.status-in-progress .tl-bar-fill { background: rgba(245,158,11,0.5); }
.tl-bar.status-in-progress .tl-bar-label { color: var(--amber); }

.tl-bar.status-not-started { background: rgba(91,156,246,0.10); }
.tl-bar.status-not-started .tl-bar-fill { background: rgba(91,156,246,0.4); }
.tl-bar.status-not-started .tl-bar-label { color: var(--blue); }

.tl-bar.status-recommended { background: rgba(167,139,250,0.10); border: 1px dashed rgba(167,139,250,0.3); }
.tl-bar.status-recommended .tl-bar-fill { background: rgba(167,139,250,0.3); }
.tl-bar.status-recommended .tl-bar-label { color: var(--violet); }

/* ‚îÄ‚îÄ‚îÄ CALENDAR VIEW ‚îÄ‚îÄ‚îÄ */
.cal-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 18px; }
@media (max-width: 900px) { .cal-grid { grid-template-columns: 1fr 1fr; } }
@media (max-width: 600px) { .cal-grid { grid-template-columns: 1fr; } }

.cal-month { background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; }
.cal-month-head {
  padding: 12px 16px;
  background: rgba(0,0,0,0.2);
  border-bottom: 1px solid var(--border);
  font-family: var(--font-d); font-size: 13px; font-weight: 700;
  color: #fff;
}
.cal-month-head span { color: var(--text-muted); font-weight: 400; font-size: 11px; margin-left: 6px; }
.cal-days-head {
  display: grid; grid-template-columns: repeat(7, 1fr);
  padding: 8px 8px 4px;
}
.cal-day-name { text-align: center; font-size: 9px; color: var(--text-muted); letter-spacing: 0.06em; text-transform: uppercase; }
.cal-days {
  display: grid; grid-template-columns: repeat(7, 1fr);
  padding: 0 8px 10px;
  gap: 2px;
}
.cal-day {
  aspect-ratio: 1; display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  border-radius: 5px; font-size: 11px; color: var(--text-dim);
  position: relative; padding: 2px; cursor: default;
}
.cal-day.empty { opacity: 0; }
.cal-day.today { background: rgba(0,212,170,0.12); color: var(--teal); font-weight: 700; }
.cal-day.has-event { cursor: pointer; }
.cal-day.has-event:hover { background: rgba(255,255,255,0.06); }
.cal-dot { width: 4px; height: 4px; border-radius: 50%; margin-top: 1px; }

.cal-events-legend { margin-top: 20px; }
.cal-legend-title {
  font-family: var(--font-d); font-size: 11px; font-weight: 700;
  letter-spacing: 0.1em; text-transform: uppercase;
  color: var(--text-muted); margin-bottom: 10px;
}
.cal-event-item {
  display: flex; align-items: center; gap: 10px;
  padding: 8px 0; border-bottom: 1px solid var(--border);
  font-size: 12px;
}
.cal-event-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.cal-event-name { color: var(--text); font-family: var(--font-d); font-weight: 600; }
.cal-event-date { color: var(--text-muted); font-size: 11px; margin-left: auto; }

/* ‚îÄ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ‚îÄ */
.modal-overlay {
  display: none; position: fixed; inset: 0; z-index: 999;
  background: rgba(4,9,18,0.85); backdrop-filter: blur(8px);
  align-items: center; justify-content: center;
}
.modal-overlay.open { display: flex; }
.modal {
  background: var(--surface);
  border: 1px solid var(--border-bright);
  border-radius: 14px;
  width: 100%; max-width: 560px;
  max-height: 92vh; overflow-y: auto;
  padding: 28px;
  animation: modalIn 0.25s ease;
  box-shadow: 0 32px 80px rgba(0,0,0,0.6);
  position: relative;
}
@keyframes modalIn {
  from { opacity:0; transform: scale(0.95) translateY(12px); }
  to { opacity:1; transform: none; }
}
.modal-head {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 22px;
}
.modal-title { font-family: var(--font-d); font-size: 18px; font-weight: 800; color: #fff; }
.modal-close {
  width: 30px; height: 30px; border-radius: 6px; border: 1px solid var(--border);
  background: var(--card); cursor: pointer; color: var(--text-muted);
  display: flex; align-items: center; justify-content: center;
  font-size: 18px; transition: all 0.15s;
}
.modal-close:hover { background: var(--red-dim); color: var(--red); border-color: rgba(248,113,113,0.3); }

.form-row { margin-bottom: 16px; }
.form-row-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
label {
  display: block; font-size: 10px; font-weight: 500;
  letter-spacing: 0.1em; text-transform: uppercase;
  color: var(--text-muted); margin-bottom: 6px;
}
input[type="text"], input[type="url"], input[type="number"], input[type="date"], select, textarea {
  width: 100%; padding: 10px 12px;
  background: var(--card); border: 1px solid var(--border);
  border-radius: 7px; color: var(--text); font-family: var(--font-m);
  font-size: 12px; outline: none;
  transition: border-color 0.15s, box-shadow 0.15s;
}
input[type="text"]:focus, input[type="url"]:focus, input[type="number"]:focus,
input[type="date"]:focus, select:focus, textarea:focus {
  border-color: rgba(0,212,170,0.4);
  box-shadow: 0 0 0 3px rgba(0,212,170,0.08);
}
input[type="date"] { color-scheme: dark; }
select option { background: var(--card); }
textarea { resize: vertical; min-height: 70px; }

.modal-actions { display: flex; gap: 10px; margin-top: 22px; padding-top: 18px; border-top: 1px solid var(--border); }
.btn-primary {
  flex: 1; padding: 10px; border-radius: 8px;
  background: var(--teal); border: none; color: #00100d;
  font-family: var(--font-d); font-size: 13px; font-weight: 700;
  cursor: pointer; transition: all 0.15s;
}
.btn-primary:hover { opacity: 0.85; }
.btn-cancel {
  padding: 10px 20px; border-radius: 8px;
  background: var(--card); border: 1px solid var(--border); color: var(--text-muted);
  font-family: var(--font-m); font-size: 12px; cursor: pointer;
  transition: all 0.15s;
}
.btn-cancel:hover { color: var(--text); border-color: var(--border-bright); }

/* ‚îÄ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ‚îÄ */
.empty { text-align: center; padding: 60px 20px; color: var(--text-muted); }
.empty-icon { font-size: 40px; margin-bottom: 12px; opacity: 0.5; }
.empty p { font-size: 13px; line-height: 1.7; }

/* ‚îÄ‚îÄ‚îÄ SYNC BANNER ‚îÄ‚îÄ‚îÄ */
#sync-banner {
  display: none;
  align-items: center; gap: 12px;
  padding: 10px 28px;
  background: rgba(79,158,255,0.08);
  border-bottom: 1px solid rgba(79,158,255,0.18);
  font-size: 12px; color: var(--text-dim);
  transition: var(--theme-transition);
}
body.light #sync-banner { background: rgba(37,99,235,0.06); border-bottom-color: rgba(37,99,235,0.18); }
#sync-banner.show { display: flex; }
.sync-banner-icon { font-size: 15px; }
.sync-banner-text { flex: 1; }
.sync-banner-text strong { color: var(--text); }
.sync-banner-btn {
  padding: 5px 14px; border-radius: 6px; cursor: pointer;
  background: var(--blue-dim); border: 1px solid rgba(79,158,255,0.35);
  color: var(--blue); font-family: var(--font-d); font-size: 11px; font-weight: 700;
  transition: all 0.15s; white-space: nowrap;
}
.sync-banner-btn:hover { background: var(--blue); color: #fff; }
.sync-banner-dismiss {
  background: none; border: none; cursor: pointer;
  color: var(--text-muted); font-size: 18px; line-height: 1; padding: 0 4px;
}
.sync-banner-dismiss:hover { color: var(--text); }

/* Sync status pill in header */
.sync-pill {
  display: flex; align-items: center; gap: 6px;
  padding: 5px 12px; border-radius: 20px;
  font-size: 11px; font-family: var(--font-m); white-space: nowrap;
  border: 1px solid transparent; transition: all 0.3s;
}
.sync-pill.synced { background: var(--teal-dim); border-color: rgba(0,229,184,0.25); color: var(--teal); }
.sync-pill.syncing { background: var(--amber-dim); border-color: rgba(255,176,32,0.25); color: var(--amber); }
.sync-pill.offline { display: none; }
.sync-dot { width: 7px; height: 7px; border-radius: 50%; background: currentColor; }
@keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.3} }
.sync-dot.pulse { animation: blink 1.2s ease-in-out infinite; }

/* ‚îÄ‚îÄ‚îÄ FIREBASE SETUP MODAL ‚îÄ‚îÄ‚îÄ */
#firebase-modal-overlay {
  display: none; position: fixed; inset: 0; z-index: 1500;
  background: rgba(4,9,18,0.85); backdrop-filter: blur(8px);
  align-items: center; justify-content: center; padding: 24px;
}
#firebase-modal-overlay.open { display: flex; }
.fb-modal {
  background: var(--surface); border: 1px solid var(--border-bright);
  border-radius: 16px; max-width: 560px; width: 100%; padding: 32px;
  box-shadow: 0 40px 100px rgba(0,0,0,0.6);
  animation: modalIn 0.2s ease;
}
.fb-modal-head { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px; }
.fb-modal-title { font-family: var(--font-d); font-size: 20px; font-weight: 800; color: var(--text-heading); }
.fb-modal-close {
  width: 28px; height: 28px; border-radius: 6px; border: 1px solid var(--border);
  background: var(--card); cursor: pointer; color: var(--text-muted);
  display: flex; align-items: center; justify-content: center; font-size: 18px;
  transition: all 0.15s; flex-shrink: 0;
}
.fb-modal-close:hover { background: var(--red-dim); color: var(--red); }
.fb-modal-sub { color: var(--text-muted); font-size: 12px; line-height: 1.6; margin-bottom: 22px; }
.fb-step {
  display: flex; gap: 12px; margin-bottom: 14px; align-items: flex-start;
}
.fb-step-num {
  width: 24px; height: 24px; border-radius: 50%; flex-shrink: 0;
  background: var(--blue-dim); border: 1px solid rgba(79,158,255,0.3);
  color: var(--blue); font-family: var(--font-d); font-size: 11px; font-weight: 700;
  display: flex; align-items: center; justify-content: center;
}
.fb-step-text { font-size: 12px; color: var(--text-dim); line-height: 1.6; padding-top: 2px; }
.fb-step-text strong { color: var(--text); }
.fb-step-text a { color: var(--blue); }
.fb-field { margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border); }
.fb-field label { color: var(--text-muted); font-size: 10px; letter-spacing: 0.1em; text-transform: uppercase; display: block; margin-bottom: 6px; }
.fb-textarea {
  width: 100%; min-height: 110px; padding: 10px 12px;
  background: var(--card); border: 1px solid var(--border);
  border-radius: 8px; color: var(--text); font-family: var(--font-m);
  font-size: 11px; resize: vertical; outline: none;
  transition: border-color 0.15s;
}
.fb-textarea:focus { border-color: rgba(79,158,255,0.4); box-shadow: 0 0 0 3px rgba(79,158,255,0.08); }
.fb-err { color: var(--red); font-size: 11px; margin-top: 6px; min-height: 16px; }
.fb-actions { display: flex; gap: 10px; margin-top: 16px; }

/* ‚îÄ‚îÄ‚îÄ PROGRESS TAB ‚îÄ‚îÄ‚îÄ */
.prog-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 18px;
  margin-bottom: 18px;
}
@media (max-width: 700px) { .prog-grid { grid-template-columns: 1fr; } }

.prog-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 24px;
  transition: var(--theme-transition);
}
.prog-card-full {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 24px;
  margin-bottom: 18px;
  transition: var(--theme-transition);
}
.prog-card-title {
  font-family: var(--font-d); font-size: 11px; font-weight: 700;
  letter-spacing: 0.12em; text-transform: uppercase;
  color: var(--text-muted); margin-bottom: 20px;
}

/* Big donut */
.donut-wrap {
  display: flex; align-items: center; justify-content: center;
  gap: 32px; flex-wrap: wrap;
}
.donut-svg-wrap { position: relative; flex-shrink: 0; }
.donut-center {
  position: absolute; inset: 0;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  pointer-events: none;
}
.donut-pct {
  font-family: var(--font-d); font-size: 32px; font-weight: 800;
  color: var(--text-heading); line-height: 1;
}
.donut-label { font-size: 10px; color: var(--text-muted); letter-spacing: 0.08em; text-transform: uppercase; margin-top: 3px; }

.donut-legend { display: flex; flex-direction: column; gap: 12px; }
.donut-legend-item { display: flex; align-items: center; gap: 10px; }
.donut-legend-swatch { width: 10px; height: 10px; border-radius: 3px; flex-shrink: 0; }
.donut-legend-name { font-size: 12px; color: var(--text); font-family: var(--font-d); font-weight: 600; }
.donut-legend-sub { font-size: 11px; color: var(--text-muted); margin-top: 1px; }
.donut-legend-count { margin-left: auto; font-size: 13px; font-weight: 700; font-family: var(--font-d); }

/* Phase progress bars */
.phase-bar-row { margin-bottom: 18px; }
.phase-bar-row:last-child { margin-bottom: 0; }
.phase-bar-meta {
  display: flex; align-items: baseline; justify-content: space-between;
  margin-bottom: 7px;
}
.phase-bar-name { font-family: var(--font-d); font-size: 13px; font-weight: 700; color: var(--text-heading); }
.phase-bar-pct { font-family: var(--font-d); font-size: 13px; font-weight: 700; }
.phase-bar-sub { font-size: 11px; color: var(--text-muted); margin-top: 1px; }
.phase-bar-track {
  height: 10px; border-radius: 10px;
  background: var(--border);
  overflow: hidden;
}
body.light .phase-bar-track { background: rgba(60,100,180,0.12); }
.phase-bar-fill {
  height: 100%; border-radius: 10px;
  transition: width 0.8s cubic-bezier(0.4,0,0.2,1);
}

/* Hours chart */
.hours-bars { display: flex; flex-direction: column; gap: 10px; }
.hours-row { display: flex; align-items: center; gap: 12px; }
.hours-label {
  width: 150px; flex-shrink: 0;
  font-size: 11px; color: var(--text);
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  font-family: var(--font-d); font-weight: 600;
}
@media (max-width: 500px) { .hours-label { width: 100px; } }
.hours-track { flex: 1; height: 8px; border-radius: 8px; background: var(--border); overflow: hidden; }
body.light .hours-track { background: rgba(60,100,180,0.12); }
.hours-fill { height: 100%; border-radius: 8px; transition: width 0.7s ease; }
.hours-val { width: 38px; text-align: right; font-size: 11px; color: var(--text-muted); font-family: var(--font-m); flex-shrink: 0; }

/* Stat hero numbers */
.stat-heroes {
  display: grid; grid-template-columns: repeat(4, 1fr);
  gap: 12px; margin-bottom: 18px;
}
@media (max-width: 600px) { .stat-heroes { grid-template-columns: repeat(2,1fr); } }
.stat-hero {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 18px 16px;
  text-align: center; transition: var(--theme-transition);
}
.stat-hero-num {
  font-family: var(--font-d); font-size: 36px; font-weight: 800;
  line-height: 1; margin-bottom: 4px;
}
.stat-hero-label { font-size: 10px; color: var(--text-muted); letter-spacing: 0.1em; text-transform: uppercase; }

/* ‚îÄ‚îÄ‚îÄ SCROLLBAR ‚îÄ‚îÄ‚îÄ */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: var(--bg); }
::-webkit-scrollbar-thumb { background: var(--border-bright); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

/* ‚îÄ‚îÄ‚îÄ TOOLTIP ‚îÄ‚îÄ‚îÄ */
[data-tip] { position: relative; }
[data-tip]:hover::after {
  content: attr(data-tip);
  position: absolute; bottom: calc(100% + 8px); left: 50%; transform: translateX(-50%);
  background: var(--surface); border: 1px solid var(--border-bright);
  padding: 5px 10px; border-radius: 5px;
  font-size: 10px; color: var(--text); white-space: nowrap;
  pointer-events: none; z-index: 999;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

/* ‚îÄ‚îÄ‚îÄ SECTION INTRO ‚îÄ‚îÄ‚îÄ */
.section-note {
  font-size: 11px; color: var(--text-muted); margin-bottom: 20px;
  padding: 10px 14px; background: var(--card); border-left: 3px solid var(--amber);
  border-radius: 0 6px 6px 0;
  transition: var(--theme-transition);
}

/* Light mode input date fix */
body.light input[type="date"] { color-scheme: light; }
body.light .modal-overlay { background: rgba(200,215,240,0.7); }
body.light .modal { box-shadow: 0 32px 80px rgba(0,50,150,0.12); }
body.light select option { background: #ffffff; color: #1e3a5f; }
</style>
</head>
<body>

<!-- HEADER -->
<div id="header">
  <div class="logo">
    <div class="logo-dot"></div>
    AI Learning Dashboard
  </div>
  <div class="sync-pill offline" id="sync-pill">
    <div class="sync-dot" id="sync-dot"></div>
    <span id="sync-label">Synced</span>
  </div>
  <button class="theme-toggle" id="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark mode">üåô</button>
</div>

<!-- SYNC BANNER -->
<div id="sync-banner">
  <span class="sync-banner-icon">‚òÅÔ∏è</span>
  <span class="sync-banner-text"><strong>Cross-device sync not set up.</strong> Your progress saves on this device only. Connect Firebase to sync across all your devices.</span>
  <button class="sync-banner-btn" onclick="openFirebaseModal()">Connect Firebase</button>
  <button class="sync-banner-dismiss" onclick="dismissBanner()" title="Dismiss">√ó</button>
</div>

<!-- TABS -->
<div id="tabs">
  <button class="tab-btn active" onclick="switchTab('dashboard')">
    Dashboard <span class="tab-count" id="tc-dashboard">0</span>
  </button>
  <button class="tab-btn" onclick="switchTab('progress')">
    Progress
  </button>
  <button class="tab-btn" onclick="switchTab('timeline')">
    Timeline
  </button>
  <button class="tab-btn" onclick="switchTab('calendar')">
    Calendar
  </button>
  <button class="add-btn" onclick="openModal()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
    Add Course
  </button>
</div>

<!-- MAIN -->
<div id="main">

  <!-- DASHBOARD -->
  <div id="view-dashboard" class="view active">
    <div id="dashboard-content"></div>
  </div>

  <!-- PROGRESS -->
  <div id="view-progress" class="view">
    <div id="progress-content"></div>
  </div>

  <!-- TIMELINE -->
  <div id="view-timeline" class="view">
    <div class="section-note">Each bar represents a course from start ‚Üí target date. The amber line marks today. Click any course name to jump to its card.</div>
    <div class="timeline-wrap">
      <div id="timeline-content"></div>
    </div>
  </div>

  <!-- CALENDAR -->
  <div id="view-calendar" class="view">
    <div class="section-note">Target completion dates shown below. Click a date to see which courses are due.</div>
    <div class="cal-grid" id="calendar-content"></div>
    <div class="cal-events-legend" id="cal-events-list"></div>
  </div>

</div>

<!-- MODAL -->
<div class="modal-overlay" id="modal-overlay" onclick="handleOverlayClick(event)">
  <div class="modal">
    <div class="modal-head">
      <div class="modal-title" id="modal-title">Add Course</div>
      <button class="modal-close" onclick="closeModal()">√ó</button>
    </div>
    <form id="course-form" onsubmit="handleFormSubmit(event)">
      <input type="hidden" id="f-id">
      <div class="form-row">
        <label>Course / Resource Name *</label>
        <input type="text" id="f-name" required placeholder="e.g. Python for Everybody">
      </div>
      <div class="form-row">
        <label>Provider / Author</label>
        <input type="text" id="f-provider" placeholder="e.g. Andrew Ng ¬∑ DeepLearning.AI">
      </div>
      <div class="form-row">
        <label>URL</label>
        <input type="url" id="f-url" placeholder="https://...">
      </div>
      <div class="form-row">
        <label>Description</label>
        <textarea id="f-description" placeholder="What will you learn?"></textarea>
      </div>
      <div class="form-row-2">
        <div class="form-row">
          <label>Phase</label>
          <select id="f-phase">
            <option value="1">Phase 1 ‚Äî Foundations</option>
            <option value="2">Phase 2 ‚Äî Bridge</option>
            <option value="3">Phase 3 ‚Äî Branching</option>
            <option value="4">Phase 4 ‚Äî Advanced</option>
          </select>
        </div>
        <div class="form-row">
          <label>Status</label>
          <select id="f-status">
            <option value="not-started">Not Started</option>
            <option value="in-progress">In Progress</option>
            <option value="completed">Completed</option>
            <option value="recommended">Suggested</option>
          </select>
        </div>
      </div>
      <div class="form-row-2">
        <div class="form-row">
          <label>Progress %</label>
          <input type="number" id="f-progress" min="0" max="100" value="0">
        </div>
        <div class="form-row">
          <label>Est. Hours</label>
          <input type="number" id="f-hours" min="0" step="0.5" placeholder="e.g. 10">
        </div>
      </div>
      <div class="form-row-2">
        <div class="form-row">
          <label>Start Date</label>
          <input type="date" id="f-start">
        </div>
        <div class="form-row">
          <label>Target Complete</label>
          <input type="date" id="f-target">
        </div>
      </div>
      <div class="form-row-2">
        <div class="form-row">
          <label>Cost</label>
          <input type="text" id="f-cost" placeholder="e.g. Free / ¬£49/mo">
        </div>
        <div class="form-row">
          <label>Format</label>
          <input type="text" id="f-format" placeholder="e.g. Online Course">
        </div>
      </div>
      <div class="form-row">
        <label>Tags (comma separated)</label>
        <input type="text" id="f-tags" placeholder="e.g. GenAI, Strategy, No-code">
      </div>
      <div class="modal-actions">
        <button type="button" class="btn-cancel" onclick="closeModal()">Cancel</button>
        <button type="submit" class="btn-primary" id="form-submit-btn">Save Course</button>
      </div>
    </form>
  </div>
</div>

<script>
// ‚îÄ‚îÄ‚îÄ DATA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const DEFAULT_COURSES = [
  { id:1, name:"Various AI Introductions", provider:"Multiple platforms", url:"", phase:1, status:"completed", progress:100, hours:10, start:"2026-01-01", target:"2026-02-10", cost:"Free", format:"Mixed", description:"General orientation ‚Äî what AI is, key terms, and basic concepts. Completed various bite-sized introductory content.", tags:["Introductory"] },
  { id:2, name:"AI for Everyone", provider:"Andrew Ng ¬∑ DeepLearning.AI", url:"https://www.coursera.org/learn/ai-for-everyone", phase:1, status:"in-progress", progress:50, hours:7, start:"2026-02-01", target:"2026-03-10", cost:"Free to audit", format:"Online Course", description:"Non-technical overview of AI strategy, capabilities, and limitations. The best single course for understanding AI without coding.", tags:["Strategy","No-code"] },
  { id:3, name:"Generative AI for Everyone", provider:"Andrew Ng ¬∑ DeepLearning.AI", url:"https://www.coursera.org/learn/generative-ai-for-everyone", phase:1, status:"not-started", progress:0, hours:10, start:"2026-03-10", target:"2026-04-10", cost:"Free to audit", format:"Online Course", description:"Deep dive into LLMs, prompt engineering, and real-world GenAI applications. A natural step up from AI for Everyone.", tags:["GenAI","LLMs"] },
  { id:4, name:"Generative AI & LLMs for Dummies", provider:"Book ‚Äî Wiley", url:"https://www.amazon.co.uk/Generative-AI-LLMs-Dummies-Computer/dp/1394245114", phase:1, status:"not-started", progress:0, hours:15, start:"2026-03-01", target:"2026-04-15", cost:"Paid", format:"Book", description:"Accessible deep-dive into how generative AI and large language models actually work, with real-world context. Best read alongside or after Generative AI for Everyone.", tags:["GenAI","Reading"] },
  { id:5, name:"AI Python for Beginners", provider:"Andrew Ng ¬∑ DeepLearning.AI", url:"https://www.deeplearning.ai/courses/ai-python-for-beginners/", phase:2, status:"recommended", progress:0, hours:8, start:"2026-03-15", target:"2026-04-15", cost:"Free", format:"Short Course (4 parts)", description:"Teaches Python from scratch but frames everything around AI use cases from day one ‚Äî working with LLMs, APIs, and data. Purpose-built for non-coders entering the AI world. ‚ö† Do this before the Agentic AI course.", tags:["Python","AI-focused","‚ö† Do First"] },
  { id:6, name:"Python for Data Science & ML (LinkedIn Learning)", provider:"Lillian Pierson ¬∑ LinkedIn Learning", url:"https://www.linkedin.com/learning/python-for-data-science-and-machine-learning-essential-training-part-1", phase:2, status:"recommended", progress:0, hours:8, start:"2026-04-15", target:"2026-05-15", cost:"LinkedIn subscription", format:"Online Course", description:"Hands-on project-based course building a web scraper and ML pipeline using Pandas, NumPy, and Streamlit. Best taken after AI Python for Beginners ‚Äî it assumes some Python familiarity but rewards you with real data science skills.", tags:["Python","Data Science","Step 2"] },
  { id:7, name:"Prompt Engineering for Developers", provider:"Andrew Ng & OpenAI ¬∑ DeepLearning.AI", url:"https://www.deeplearning.ai/short-courses/chatgpt-prompt-engineering-for-developers/", phase:2, status:"recommended", progress:0, hours:2, start:"2026-03-20", target:"2026-03-27", cost:"Free", format:"Short Course", description:"Short, practical course on writing prompts that actually work. Covers system prompts, few-shot examples, and chain-of-thought. A quick win ‚Äî 2 hours and immediately useful.", tags:["Prompting","Quick Win"] },
  { id:8, name:"Vibe Coding Essentials", provider:"Scrimba via Coursera", url:"https://www.coursera.org/specializations/vibe-coding", phase:3, status:"not-started", progress:0, hours:40, start:"2026-05-01", target:"2026-07-01", cost:"Free to audit", format:"Specialisation", description:"Learn to turn ideas into working software using GitHub Copilot, Cursor AI, and Claude Code ‚Äî no deep coding experience required. Covers prompt strategies, deployment, and debugging.", tags:["Vibe Coding","Building"] },
  { id:9, name:"Agentic AI", provider:"Andrew Ng ¬∑ DeepLearning.AI", url:"https://www.deeplearning.ai/courses/agentic-ai/", phase:3, status:"not-started", progress:0, hours:25, start:"2026-06-01", target:"2026-08-01", cost:"Paid", format:"Online Course", description:"Build autonomous multi-step AI systems using reflection, tool use, planning, and multi-agent collaboration. Taught in raw Python ‚Äî not hidden behind a framework. ‚ö† Complete AI Python for Beginners first.", tags:["Agents","Python","Technical"] },
  { id:10, name:"AI Product Management Specialisation", provider:"Duke University via Coursera", url:"https://www.coursera.org/specializations/ai-product-management-duke", phase:3, status:"not-started", progress:0, hours:60, start:"2026-05-15", target:"2026-09-15", cost:"Free to audit / ~¬£49/mo cert", format:"Specialisation", description:"University-backed programme covering ML fundamentals for PMs, managing AI projects, human-centred AI design, and ethics. No coding required. Strong credential for your CV.", tags:["Product","Strategy","No-code"] },
];

// ‚îÄ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const STORAGE_KEY = 'ai_learning_v4';
const FB_CONFIG_KEY = 'ai_firebase_config';
let courses = [];
let editingId = null;
let expandedId = null;
let dbRef = null;
let saveDebounce = null;

function nextId() {
  return courses.length ? Math.max(...courses.map(c => c.id)) + 1 : 1;
}

// ‚îÄ‚îÄ‚îÄ LOCAL STORAGE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function loadLocal() {
  try {
    const saved = localStorage.getItem(STORAGE_KEY);
    return saved ? JSON.parse(saved) : JSON.parse(JSON.stringify(DEFAULT_COURSES));
  } catch(e) {
    return JSON.parse(JSON.stringify(DEFAULT_COURSES));
  }
}

function saveLocal(data) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
}

// ‚îÄ‚îÄ‚îÄ SAVE (local always, firebase if connected) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function saveData() {
  saveLocal(courses);
  if (dbRef) {
    clearTimeout(saveDebounce);
    saveDebounce = setTimeout(() => {
      setSyncStatus('syncing');
      dbRef.set(courses)
        .then(() => setSyncStatus('synced'))
        .catch(() => setSyncStatus('error'));
    }, 700);
  }
}

// ‚îÄ‚îÄ‚îÄ SYNC STATUS PILL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function setSyncStatus(state) {
  const pill = document.getElementById('sync-pill');
  const dot = document.getElementById('sync-dot');
  const lbl = document.getElementById('sync-label');
  if (!pill) return;
  pill.className = 'sync-pill ' + (state === 'synced' || state === 'syncing' ? state : 'offline');
  dot.className = 'sync-dot' + (state === 'syncing' ? ' pulse' : '');
  lbl.textContent = state === 'synced' ? 'Synced ‚úì' : state === 'syncing' ? 'Saving‚Ä¶' : 'Sync error';
}

// ‚îÄ‚îÄ‚îÄ FIREBASE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function getSavedFbConfig() {
  try { return JSON.parse(localStorage.getItem(FB_CONFIG_KEY)); } catch(e) { return null; }
}

function parseFbConfig(raw) {
  // Wrap in braces if bare key:value list
  let s = raw.trim();
  if (!s.startsWith('{')) s = '{' + s + '}';
  // Quote unquoted keys
  s = s.replace(/([{,]\s*)([a-zA-Z_][a-zA-Z0-9_]*)\s*:/g, '$1"$2":');
  // Remove trailing commas before }
  s = s.replace(/,(\s*})/g, '$1');
  try {
    const cfg = JSON.parse(s);
    if (!cfg.apiKey || !cfg.databaseURL) throw new Error('missing fields');
    return cfg;
  } catch(e) {
    // fallback: eval (handles JS object literals)
    try {
      const cfg = Function('"use strict";return(' + raw + ')')();
      if (!cfg.apiKey || !cfg.databaseURL) throw new Error('missing fields');
      return cfg;
    } catch(e2) { return null; }
  }
}

function connectFirebase(cfg) {
  try {
    if (firebase.apps.length) firebase.apps.forEach(app => app.delete());
    firebase.initializeApp(cfg);
    const db = firebase.database();
    dbRef = db.ref('ai_learning/courses');
    // Listen for remote changes
    dbRef.on('value', snapshot => {
      const remote = snapshot.val();
      if (remote && Array.isArray(remote) && remote.length > 0) {
        courses = remote;
        saveLocal(courses);
        renderCurrentTab();
      } else if (!remote) {
        // First time connecting ‚Äî push local data up
        dbRef.set(courses);
      }
      setSyncStatus('synced');
    }, err => {
      console.warn('Firebase error:', err);
      setSyncStatus('error');
    });
    localStorage.setItem(FB_CONFIG_KEY, JSON.stringify(cfg));
    hideBanner();
  } catch(e) {
    console.error('Firebase init failed:', e);
    dbRef = null;
  }
}

// ‚îÄ‚îÄ‚îÄ FIREBASE MODAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openFirebaseModal() {
  document.getElementById('firebase-modal-overlay').classList.add('open');
  document.getElementById('fb-err').textContent = '';
}
function closeFirebaseModal() {
  document.getElementById('firebase-modal-overlay').classList.remove('open');
}
function handleFbOverlayClick(e) {
  if (e.target === document.getElementById('firebase-modal-overlay')) closeFirebaseModal();
}
function submitFirebaseConfig() {
  const raw = document.getElementById('fb-paste-area').value.trim();
  document.getElementById('fb-err').textContent = '';
  if (!raw) { document.getElementById('fb-err').textContent = '‚ö† Please paste your Firebase config first.'; return; }
  const cfg = parseFbConfig(raw);
  if (!cfg) {
    document.getElementById('fb-err').textContent = '‚ö† Could not parse config ‚Äî make sure you pasted the full contents of the firebaseConfig { } object.';
    return;
  }
  connectFirebase(cfg);
  closeFirebaseModal();
}

// ‚îÄ‚îÄ‚îÄ SYNC BANNER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function showBanner() {
  if (localStorage.getItem('ai_banner_dismissed')) return;
  document.getElementById('sync-banner').classList.add('show');
}
function hideBanner() {
  document.getElementById('sync-banner').classList.remove('show');
}
function dismissBanner() {
  hideBanner();
  localStorage.setItem('ai_banner_dismissed', '1');
}

// ‚îÄ‚îÄ‚îÄ TABS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let currentTab = 'dashboard';

// ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function init() {
  // 1. Apply theme immediately ‚Äî no flash
  const savedTheme = localStorage.getItem('ai_theme') || 'dark';
  applyTheme(savedTheme);

  // 2. Load local data and render immediately ‚Äî page always works
  courses = loadLocal();
  renderCurrentTab();

  // 3. Try to connect Firebase in the background if config exists
  const cfg = getSavedFbConfig();
  if (cfg && cfg.apiKey && cfg.databaseURL) {
    connectFirebase(cfg);
  } else {
    showBanner();
  }
}

init();

function switchTab(tab) {
  currentTab = tab;
  const tabNames = ['dashboard','progress','timeline','calendar'];
  document.querySelectorAll('.tab-btn').forEach((btn, i) => {
    btn.classList.toggle('active', tabNames[i] === tab);
  });
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.getElementById('view-' + tab).classList.add('active');
  renderCurrentTab();
}

function renderCurrentTab() {
  document.getElementById('tc-dashboard').textContent = courses.length;
  if (currentTab === 'dashboard') renderDashboard();
  else if (currentTab === 'progress') renderProgress();
  else if (currentTab === 'timeline') renderTimeline();
  else if (currentTab === 'calendar') renderCalendar();
}

// ‚îÄ‚îÄ‚îÄ PROGRESS TAB ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderProgress() {
  const total = courses.length;
  if (!total) {
    document.getElementById('progress-content').innerHTML = `<div class="empty"><div class="empty-icon">üìä</div><p>No courses yet.<br>Add some courses to see your progress.</p></div>`;
    return;
  }

  const done      = courses.filter(c => c.status === 'completed').length;
  const active    = courses.filter(c => c.status === 'in-progress').length;
  const planned   = courses.filter(c => c.status === 'not-started').length;
  const suggested = courses.filter(c => c.status === 'recommended').length;
  const overallPct = Math.round(courses.reduce((s,c) => s+(c.progress||0),0) / total);
  const totalHours = courses.reduce((s,c) => s+(c.hours||0), 0);
  const doneHours  = courses.filter(c => c.status==='completed').reduce((s,c) => s+(c.hours||0), 0);
  const phases     = [...new Set(courses.map(c=>c.phase))].sort((a,b)=>a-b);

  // ‚îÄ‚îÄ SVG Donut helper ‚îÄ‚îÄ
  function donut(segments, size=160, thickness=22) {
    const r = (size/2) - thickness/2 - 2;
    const circ = 2 * Math.PI * r;
    const cx = size/2, cy = size/2;
    let offset = 0;
    // Start gap (small visual gap between segments)
    const gap = total > 1 ? 3 : 0;
    const paths = segments.map(seg => {
      if (!seg.count) return '';
      const frac = seg.count / total;
      const dash = frac * circ - gap;
      const path = `<circle cx="${cx}" cy="${cy}" r="${r}" fill="none"
        stroke="${seg.color}" stroke-width="${thickness}"
        stroke-dasharray="${dash.toFixed(2)} ${(circ-dash).toFixed(2)}"
        stroke-dashoffset="${(-offset * circ / total + circ/4).toFixed(2)}"
        stroke-linecap="round"
        style="transition:stroke-dasharray 0.8s ease"/>`;
      offset += seg.count;
      return path;
    });
    return `<svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}">${paths.join('')}</svg>`;
  }

  const style = getComputedStyle(document.body);
  const C = {
    teal:   style.getPropertyValue('--teal').trim()   || '#00e5b8',
    amber:  style.getPropertyValue('--amber').trim()  || '#ffb020',
    blue:   style.getPropertyValue('--blue').trim()   || '#4f9eff',
    violet: style.getPropertyValue('--violet').trim() || '#b97fff',
    pink:   style.getPropertyValue('--pink').trim()   || '#ff6eb4',
  };
  const phaseColors = [C.blue, C.violet, C.pink, C.teal];

  const statusSegments = [
    { label:'Completed',  sublabel:`${done} course${done!==1?'s':''}`,   count:done,      color:C.teal   },
    { label:'In Progress',sublabel:`${active} course${active!==1?'s':''}`,count:active,    color:C.amber  },
    { label:'Planned',    sublabel:`${planned} course${planned!==1?'s':''}`,count:planned, color:C.blue   },
    { label:'Suggested',  sublabel:`${suggested} course${suggested!==1?'s':''}`,count:suggested,color:C.violet},
  ];

  const legendItems = statusSegments.map(s => `
    <div class="donut-legend-item">
      <div class="donut-legend-swatch" style="background:${s.color}"></div>
      <div>
        <div class="donut-legend-name">${s.label}</div>
        <div class="donut-legend-sub">${s.sublabel}</div>
      </div>
      <div class="donut-legend-count" style="color:${s.color}">${s.count}</div>
    </div>`).join('');

  // ‚îÄ‚îÄ Phase progress bars ‚îÄ‚îÄ
  const phaseBars = phases.map((ph, i) => {
    const pCourses = courses.filter(c => c.phase === ph);
    const pPct = Math.round(pCourses.reduce((s,c)=>s+(c.progress||0),0)/pCourses.length);
    const color = phaseColors[i % phaseColors.length];
    const label = {1:'Foundations',2:'Bridge',3:'Branching Paths',4:'Advanced'}[ph] || `Phase ${ph}`;
    const pDone = pCourses.filter(c=>c.status==='completed').length;
    return `
    <div class="phase-bar-row">
      <div class="phase-bar-meta">
        <div>
          <div class="phase-bar-name" style="color:${color}">Phase ${ph} ¬∑ ${label}</div>
          <div class="phase-bar-sub">${pDone}/${pCourses.length} courses complete</div>
        </div>
        <div class="phase-bar-pct" style="color:${color}">${pPct}%</div>
      </div>
      <div class="phase-bar-track">
        <div class="phase-bar-fill" style="width:${pPct}%;background:linear-gradient(90deg,${color},${color}cc)"></div>
      </div>
    </div>`;
  }).join('');

  // ‚îÄ‚îÄ Hours bar chart ‚îÄ‚îÄ
  const maxH = Math.max(...courses.map(c=>c.hours||0), 1);
  const hoursBars = [...courses].sort((a,b)=>(b.hours||0)-(a.hours||0)).map(c => {
    const pct = Math.round(((c.hours||0)/maxH)*100);
    const color = {completed:C.teal,'in-progress':C.amber,'not-started':C.blue,recommended:C.violet}[c.status]||C.blue;
    const isDone = c.status==='completed';
    return `
    <div class="hours-row">
      <div class="hours-label" title="${c.name}" style="${isDone?'text-decoration:line-through;opacity:0.6':''}">${c.name}</div>
      <div class="hours-track"><div class="hours-fill" style="width:${pct}%;background:${color}${isDone?'88':''}"></div></div>
      <div class="hours-val">${c.hours||0}h</div>
    </div>`;
  }).join('');

  document.getElementById('progress-content').innerHTML = `
    <!-- Hero stats -->
    <div class="stat-heroes">
      <div class="stat-hero" style="border-color:rgba(0,229,184,0.25)">
        <div class="stat-hero-num" style="color:var(--teal)">${overallPct}%</div>
        <div class="stat-hero-label">Overall</div>
      </div>
      <div class="stat-hero" style="border-color:rgba(0,229,184,0.20)">
        <div class="stat-hero-num" style="color:var(--teal)">${done}</div>
        <div class="stat-hero-label">Completed</div>
      </div>
      <div class="stat-hero" style="border-color:rgba(255,176,32,0.20)">
        <div class="stat-hero-num" style="color:var(--amber)">${active}</div>
        <div class="stat-hero-label">In Progress</div>
      </div>
      <div class="stat-hero" style="border-color:rgba(79,158,255,0.20)">
        <div class="stat-hero-num" style="color:var(--blue)">${doneHours}<span style="font-size:18px;font-weight:400">h</span></div>
        <div class="stat-hero-label">Hours Done</div>
      </div>
    </div>

    <!-- Donut + Phase bars side by side -->
    <div class="prog-grid">
      <div class="prog-card">
        <div class="prog-card-title">Status Breakdown</div>
        <div class="donut-wrap">
          <div class="donut-svg-wrap">
            ${donut(statusSegments, 160, 24)}
            <div class="donut-center">
              <div class="donut-pct">${overallPct}%</div>
              <div class="donut-label">complete</div>
            </div>
          </div>
          <div class="donut-legend">${legendItems}</div>
        </div>
      </div>
      <div class="prog-card">
        <div class="prog-card-title">Progress by Phase</div>
        ${phaseBars}
      </div>
    </div>

    <!-- Hours breakdown -->
    <div class="prog-card-full">
      <div class="prog-card-title">Hours per Course <span style="font-weight:400;text-transform:none;letter-spacing:0;color:var(--text-muted);font-size:10px">(${doneHours}h done of ${totalHours}h total)</span></div>
      <div class="hours-bars">${hoursBars}</div>
    </div>
  `;
}

// ‚îÄ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function getPhaseLabel(p) {
  const m = {1:'Foundations',2:'Bridge: Python & Prompting',3:'Branching Paths',4:'Advanced'};
  return m[p] || `Phase ${p}`;
}

function statusLabel(s) {
  const m = {'completed':'‚úì Completed','in-progress':'‚ñ∂ In Progress','not-started':'Planned','recommended':'‚òÖ Suggested'};
  return m[s] || s;
}

function statusCycle(s) {
  const order = ['not-started','in-progress','completed'];
  if (s === 'recommended') return 'not-started';
  const i = order.indexOf(s);
  return order[(i+1) % order.length];
}

function getRingColor(status) {
  // Use CSS variable values directly so both themes look right
  const el = document.documentElement;
  const style = getComputedStyle(document.body);
  const map = {
    'completed': style.getPropertyValue('--teal').trim() || '#00e5b8',
    'in-progress': style.getPropertyValue('--amber').trim() || '#ffb020',
    'not-started': style.getPropertyValue('--blue').trim() || '#4f9eff',
    'recommended': style.getPropertyValue('--violet').trim() || '#b97fff'
  };
  return map[status] || map['not-started'];
}

function renderRing(progress, status, id) {
  const r = 20, c = 2*Math.PI*r;
  const offset = c - (progress/100)*c;
  const color = getRingColor(status);
  return `<div class="ring-wrap" onclick="event.stopPropagation();toggleExpand(${id})" data-tip="Click to edit progress">
    <svg viewBox="0 0 50 50" width="52" height="52">
      <circle class="ring-bg" cx="25" cy="25" r="${r}" stroke-width="4"/>
      <circle class="ring-fill" cx="25" cy="25" r="${r}" stroke-width="4"
        stroke="${color}" stroke-dasharray="${c.toFixed(2)}" stroke-dashoffset="${offset.toFixed(2)}"
        transform="rotate(-90 25 25)"/>
    </svg>
    <div class="ring-label">${progress}%</div>
  </div>`;
}

function renderCard(course) {
  const isExpanded = expandedId === course.id;
  const tagsHtml = (course.tags||[]).map(t => `<span class="badge badge-tag">${t}</span>`).join('');
  const linkIcon = course.url
    ? `<a class="card-name-link" href="${course.url}" target="_blank" onclick="event.stopPropagation()" title="Open course">‚Üó</a>`
    : '';
  const expandedLink = course.url
    ? `<a class="card-link" href="${course.url}" target="_blank" onclick="event.stopPropagation()">‚Üó Open Course: ${course.url.replace(/^https?:\/\//, '').replace(/\/$/, '').split('/').slice(0,3).join('/')}</a>`
    : '';

  return `<div class="course-card status-${course.status}" id="card-${course.id}" onclick="toggleExpand(${course.id})">
    <div class="card-top">
      ${renderRing(course.progress||0, course.status, course.id)}
      <div class="card-info">
        <div class="card-name">
          <span class="card-name-text">${course.name}</span>
          ${linkIcon}
        </div>
        <div class="card-provider">${course.provider||''}</div>
        <div class="card-badges">
          <span class="badge badge-status badge-${course.status}" onclick="event.stopPropagation();cycleStatus(${course.id})" data-tip="Click to change status">
            ${statusLabel(course.status)}
          </span>
          ${course.cost ? `<span class="badge badge-cost">${course.cost}</span>` : ''}
          ${tagsHtml}
        </div>
      </div>
    </div>
    <div class="card-body ${isExpanded ? 'open' : ''}" id="body-${course.id}">
      <div class="card-body-inner" onclick="event.stopPropagation()">
        ${course.description ? `<div class="card-desc">${course.description}</div>` : ''}
        <div class="progress-control">
          <div class="prog-label">
            <span>Progress</span>
            <span class="prog-val">${course.progress||0}%</span>
          </div>
          <input type="range" min="0" max="100" value="${course.progress||0}"
            oninput="updateProgress(${course.id}, this.value)"
            style="accent-color:${getRingColor(course.status)}">
        </div>
        <div class="card-meta">
          ${course.hours ? `<div class="meta-item"><div class="meta-key">Est. Hours</div><div class="meta-val">${course.hours}h</div></div>` : ''}
          ${course.format ? `<div class="meta-item"><div class="meta-key">Format</div><div class="meta-val">${course.format}</div></div>` : ''}
          ${course.start ? `<div class="meta-item"><div class="meta-key">Start</div><div class="meta-val">${fmtDate(course.start)}</div></div>` : ''}
          ${course.target ? `<div class="meta-item"><div class="meta-key">Target</div><div class="meta-val">${fmtDate(course.target)}</div></div>` : ''}
        </div>
        ${expandedLink}
        <div class="card-actions">
          <button class="btn btn-complete" onclick="markComplete(${course.id})">‚úì Mark Complete</button>
          <button class="btn btn-edit" onclick="openModal(${course.id})">Edit</button>
          <button class="btn btn-delete" onclick="deleteCourse(${course.id})">Delete</button>
        </div>
      </div>
    </div>
  </div>`;
}

function renderDashboard() {
  const phases = [...new Set(courses.map(c => c.phase))].sort((a,b)=>a-b);
  if (!phases.length) {
    document.getElementById('dashboard-content').innerHTML = `<div class="empty"><div class="empty-icon">üìö</div><p>No courses yet.<br>Click <strong>Add Course</strong> to start your journey.</p></div>`;
    return;
  }
  document.getElementById('dashboard-content').innerHTML = phases.map(ph => {
    const pCourses = courses.filter(c => c.phase === ph);
    const pPct = Math.round(pCourses.reduce((s,c) => s+(c.progress||0),0) / pCourses.length);
    return `<div class="phase-section">
      <div class="phase-header">
        <div class="phase-num phase-num-${ph}">Phase ${ph}</div>
        <div class="phase-name">${getPhaseLabel(ph)}</div>
        <div class="phase-rule"></div>
        <div class="phase-prog">${pPct}% complete</div>
      </div>
      <div class="cards-grid">${pCourses.map(renderCard).join('')}</div>
    </div>`;
  }).join('');
}

// ‚îÄ‚îÄ‚îÄ INTERACTIONS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toggleExpand(id) {
  expandedId = expandedId === id ? null : id;
  renderDashboard();
  if (expandedId) {
    setTimeout(() => {
      const el = document.getElementById('card-' + id);
      if (el) el.scrollIntoView({ behavior:'smooth', block:'nearest' });
    }, 100);
  }
}

function updateProgress(id, val) {
  const c = courses.find(x => x.id === id);
  if (!c) return;
  c.progress = parseInt(val);
  if (c.progress === 100) c.status = 'completed';
  else if (c.progress > 0 && c.status === 'not-started') c.status = 'in-progress';
  else if (c.progress > 0 && c.status === 'recommended') c.status = 'in-progress';
  saveData();
  // Update ring and label without full re-render
  const card = document.getElementById('card-' + id);
  if (card) {
    // Update ring fill
    const r = 20, circ = 2*Math.PI*r;
    const offset = circ - (c.progress/100)*circ;
    const fill = card.querySelector('.ring-fill');
    if (fill) {
      fill.setAttribute('stroke-dashoffset', offset.toFixed(2));
      fill.setAttribute('stroke', getRingColor(c.status));
    }
    const lbl = card.querySelector('.ring-label');
    if (lbl) lbl.textContent = c.progress + '%';
    const progVal = card.querySelector('.prog-val');
    if (progVal) progVal.textContent = c.progress + '%';
  }
  renderStats();
}

function cycleStatus(id) {
  const c = courses.find(x => x.id === id);
  if (!c) return;
  c.status = statusCycle(c.status);
  if (c.status === 'completed') c.progress = 100;
  else if (c.status === 'not-started' && c.progress === 100) c.progress = 0;
  saveData();
  renderDashboard();
  renderStats();
}

function markComplete(id) {
  const c = courses.find(x => x.id === id);
  if (!c) return;
  c.progress = 100; c.status = 'completed';
  saveData();
  expandedId = null;
  renderDashboard();
  renderStats();
}

function deleteCourse(id) {
  if (!confirm('Delete this course from your plan?')) return;
  courses = courses.filter(c => c.id !== id);
  if (expandedId === id) expandedId = null;
  saveData();
  renderCurrentTab();
}

// ‚îÄ‚îÄ‚îÄ TIMELINE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function fmtDate(d) {
  if (!d) return '‚Äî';
  try { return new Date(d+'T12:00:00').toLocaleDateString('en-GB',{day:'numeric',month:'short',year:'numeric'}); }
  catch(e) { return d; }
}

function renderTimeline() {
  const withDates = courses.filter(c => c.start && c.target);
  if (!withDates.length) {
    document.getElementById('timeline-content').innerHTML = `<div class="empty"><div class="empty-icon">üìÖ</div><p>Add start and target dates to your courses to see them here.</p></div>`;
    return;
  }
  const starts = withDates.map(c => new Date(c.start+'T12:00:00'));
  const ends = withDates.map(c => new Date(c.target+'T12:00:00'));
  const minD = new Date(Math.min(...starts));
  const maxD = new Date(Math.max(...ends));
  // Expand to month boundaries
  minD.setDate(1);
  maxD.setMonth(maxD.getMonth()+1); maxD.setDate(0);
  const totalMs = maxD - minD;
  const today = new Date();
  const todayPct = Math.max(0, Math.min(100, (today - minD) / totalMs * 100));

  // Build month labels
  const months = [];
  let cur = new Date(minD);
  while (cur <= maxD) {
    months.push({label: cur.toLocaleDateString('en-GB',{month:'short',year:'numeric'}), date: new Date(cur)});
    cur = new Date(cur.getFullYear(), cur.getMonth()+1, 1);
  }

  const monthsHtml = months.map(m => {
    const pct = (m.date - minD) / totalMs * 100;
    const isCurrent = m.date.getMonth() === today.getMonth() && m.date.getFullYear() === today.getFullYear();
    return `<div class="tl-month ${isCurrent?'current':''}" style="position:absolute;left:${pct.toFixed(2)}%;transform:translateX(-50%)">${m.label}</div>`;
  }).join('');

  // Group by phase
  const phases = [...new Set(courses.map(c => c.phase))].sort((a,b)=>a-b);

  let html = `<div style="display:flex;gap:0;align-items:flex-start">
    <div style="width:260px;flex-shrink:0"></div>
    <div style="flex:1;height:28px;position:relative;margin-bottom:4px;">${monthsHtml}</div>
  </div>`;

  phases.forEach(ph => {
    const pCourses = courses.filter(c => c.phase === ph);
    html += `<div style="margin-bottom:20px;">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px;padding-left:0;">
        <div style="width:260px;flex-shrink:0;padding:0 12px;">
          <div style="font-family:var(--font-d);font-size:10px;font-weight:700;letter-spacing:0.12em;text-transform:uppercase;color:var(--text-muted)">Phase ${ph} ‚Äî ${getPhaseLabel(ph)}</div>
        </div>
        <div style="flex:1;height:1px;background:var(--border)"></div>
      </div>`;

    pCourses.forEach(c => {
      if (!c.start || !c.target) {
        html += `<div class="tl-row">
          <div class="tl-name-col"><div class="tl-course-name">${c.name}</div><div class="tl-course-phase" style="color:var(--text-muted);font-style:italic">No dates set</div></div>
          <div style="flex:1;font-size:10px;color:var(--text-muted);padding:0 12px;">Add start/target dates to display here</div>
        </div>`;
        return;
      }
      const s = new Date(c.start+'T12:00:00');
      const e = new Date(c.target+'T12:00:00');
      const leftPct = Math.max(0, (s - minD) / totalMs * 100);
      const widthPct = Math.max(0.5, (e - s) / totalMs * 100);
      const fillW = Math.min(100, c.progress||0);

      html += `<div class="tl-row">
        <div class="tl-name-col">
          <div class="tl-course-name">${c.name}</div>
          <div class="tl-course-phase">${fmtDate(c.start)} ‚Üí ${fmtDate(c.target)}</div>
        </div>
        <div class="tl-bars">
          ${months.map(m => { const p = (m.date-minD)/totalMs*100; return `<div class="tl-grid-line" style="left:${p.toFixed(2)}%"></div>`; }).join('')}
          <div class="tl-today-line" style="left:${todayPct.toFixed(2)}%"></div>
          <div class="tl-bar status-${c.status}" style="left:${leftPct.toFixed(2)}%;width:${widthPct.toFixed(2)}%">
            <div class="tl-bar-fill" style="width:${fillW}%"></div>
            <div class="tl-bar-label">${c.name}</div>
          </div>
        </div>
      </div>`;
    });
    html += '</div>';
  });

  document.getElementById('timeline-content').innerHTML = html;
}

// ‚îÄ‚îÄ‚îÄ CALENDAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderCalendar() {
  const today = new Date();
  const months = [];
  for (let i = -1; i < 6; i++) {
    const d = new Date(today.getFullYear(), today.getMonth() + i, 1);
    months.push(d);
  }

  // Map target dates ‚Üí courses
  const eventMap = {};
  courses.forEach(c => {
    if (!c.target) return;
    const key = c.target;
    if (!eventMap[key]) eventMap[key] = [];
    eventMap[key].push(c);
  });

  const dayNames = ['S','M','T','W','T','F','S'];

  const calHtml = months.map(month => {
    const year = month.getFullYear(), mo = month.getMonth();
    const monthName = month.toLocaleDateString('en-GB',{month:'long',year:'numeric'});
    const firstDay = new Date(year, mo, 1).getDay();
    const daysInMonth = new Date(year, mo+1, 0).getDate();

    let daysHtml = '';
    for (let i=0; i<firstDay; i++) daysHtml += `<div class="cal-day empty"></div>`;
    for (let d=1; d<=daysInMonth; d++) {
      const dateStr = `${year}-${String(mo+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
      const isToday = today.getDate()===d && today.getMonth()===mo && today.getFullYear()===year;
      const events = eventMap[dateStr] || [];
      const dots = events.map(e => {
        const col = {completed:'var(--teal)','in-progress':'var(--amber)','not-started':'var(--blue)',recommended:'var(--violet)'}[e.status]||'#fff';
        return `<div class="cal-dot" style="background:${col}" title="${e.name}"></div>`;
      }).join('');
      daysHtml += `<div class="cal-day ${isToday?'today':''} ${events.length?'has-event':''}" ${events.length?`title="${events.map(e=>e.name).join(', ')}"`:''}>${d}${dots}</div>`;
    }

    return `<div class="cal-month">
      <div class="cal-month-head">${month.toLocaleDateString('en-GB',{month:'long'})} <span>${year}</span></div>
      <div class="cal-days-head">${dayNames.map(d=>`<div class="cal-day-name">${d}</div>`).join('')}</div>
      <div class="cal-days">${daysHtml}</div>
    </div>`;
  }).join('');

  document.getElementById('calendar-content').innerHTML = calHtml;

  // Events list below calendar
  const allEvents = courses.filter(c => c.target).sort((a,b) => new Date(a.target) - new Date(b.target));
  const col = {completed:'var(--teal)','in-progress':'var(--amber)','not-started':'var(--blue)',recommended:'var(--violet)'};
  const evHtml = allEvents.map(c => `<div class="cal-event-item">
    <div class="cal-event-dot" style="background:${col[c.status]||'#888'}"></div>
    <div class="cal-event-name">${c.name}</div>
    <div class="cal-event-date">${fmtDate(c.target)}</div>
  </div>`).join('');

  document.getElementById('cal-events-list').innerHTML = allEvents.length
    ? `<div class="cal-legend-title">All Target Dates</div>${evHtml}`
    : `<div class="empty"><p>No target dates set yet. Edit your courses to add target completion dates.</p></div>`;
}

// ‚îÄ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openModal(id) {
  editingId = id || null;
  document.getElementById('modal-title').textContent = id ? 'Edit Course' : 'Add Course';
  document.getElementById('form-submit-btn').textContent = id ? 'Save Changes' : 'Add Course';

  const c = id ? courses.find(x => x.id === id) : null;
  document.getElementById('f-id').value = c ? c.id : '';
  document.getElementById('f-name').value = c ? c.name : '';
  document.getElementById('f-provider').value = c ? (c.provider||'') : '';
  document.getElementById('f-url').value = c ? (c.url||'') : '';
  document.getElementById('f-description').value = c ? (c.description||'') : '';
  document.getElementById('f-phase').value = c ? c.phase : 1;
  document.getElementById('f-status').value = c ? c.status : 'not-started';
  document.getElementById('f-progress').value = c ? (c.progress||0) : 0;
  document.getElementById('f-hours').value = c ? (c.hours||'') : '';
  document.getElementById('f-start').value = c ? (c.start||'') : '';
  document.getElementById('f-target').value = c ? (c.target||'') : '';
  document.getElementById('f-cost').value = c ? (c.cost||'') : '';
  document.getElementById('f-format').value = c ? (c.format||'') : '';
  document.getElementById('f-tags').value = c ? (c.tags||[]).join(', ') : '';

  document.getElementById('modal-overlay').classList.add('open');
  document.getElementById('f-name').focus();
}

function closeModal() {
  document.getElementById('modal-overlay').classList.remove('open');
  editingId = null;
}

function handleOverlayClick(e) {
  if (e.target === document.getElementById('modal-overlay')) closeModal();
}

function handleFormSubmit(e) {
  e.preventDefault();
  const tagsRaw = document.getElementById('f-tags').value;
  const tags = tagsRaw.split(',').map(t=>t.trim()).filter(Boolean);

  const data = {
    name: document.getElementById('f-name').value.trim(),
    provider: document.getElementById('f-provider').value.trim(),
    url: document.getElementById('f-url').value.trim(),
    description: document.getElementById('f-description').value.trim(),
    phase: parseInt(document.getElementById('f-phase').value),
    status: document.getElementById('f-status').value,
    progress: parseInt(document.getElementById('f-progress').value)||0,
    hours: parseFloat(document.getElementById('f-hours').value)||0,
    start: document.getElementById('f-start').value,
    target: document.getElementById('f-target').value,
    cost: document.getElementById('f-cost').value.trim(),
    format: document.getElementById('f-format').value.trim(),
    tags,
  };

  if (editingId) {
    const idx = courses.findIndex(c => c.id === editingId);
    if (idx >= 0) courses[idx] = { ...courses[idx], ...data };
  } else {
    courses.push({ id: nextId(), ...data });
  }

  saveData();
  closeModal();
  renderCurrentTab();
}

// ‚îÄ‚îÄ‚îÄ KEYBOARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
document.addEventListener('keydown', e => {
  if (e.key === 'Escape') closeModal();
});

// ‚îÄ‚îÄ‚îÄ THEME ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function applyTheme(mode) {
  const isLight = mode === 'light';
  document.body.classList.toggle('light', isLight);
  const btn = document.getElementById('theme-toggle');
  if (btn) btn.textContent = isLight ? 'üåô' : '‚òÄÔ∏è';
  localStorage.setItem('ai_theme', mode);
}

function toggleTheme() {
  const current = document.body.classList.contains('light') ? 'light' : 'dark';
  applyTheme(current === 'light' ? 'dark' : 'light');
  // Re-render so ring colors update via getComputedStyle
  renderCurrentTab();
}
</script><!-- FIREBASE SETUP MODAL -->
<div id="firebase-modal-overlay" onclick="handleFbOverlayClick(event)">
  <div class="fb-modal">
    <div class="fb-modal-head">
      <div class="fb-modal-title">üîó Connect Firebase Sync</div>
      <button class="fb-modal-close" onclick="closeFirebaseModal()">√ó</button>
    </div>
    <div class="fb-modal-sub">Paste your Firebase config below. You only need to do this once per device ‚Äî it's saved in your browser and used automatically from then on.</div>
    <div class="fb-step">
      <div class="fb-step-num">1</div>
      <div class="fb-step-text">Go to <strong><a href="https://console.firebase.google.com" target="_blank">console.firebase.google.com</a></strong> ‚Üí your project ‚Üí <strong>Project Settings</strong> (gear icon) ‚Üí scroll to <strong>"Your apps"</strong> ‚Üí your web app ‚Üí <strong>SDK setup and configuration</strong></div>
    </div>
    <div class="fb-step">
      <div class="fb-step-num">2</div>
      <div class="fb-step-text">Copy everything <strong>inside</strong> the curly braces of the <strong>firebaseConfig = { ‚Ä¶ }</strong> object (not the whole line, just the contents)</div>
    </div>
    <div class="fb-step">
      <div class="fb-step-num">3</div>
      <div class="fb-step-text">Paste it below and click <strong>Connect & Sync</strong></div>
    </div>
    <div class="fb-field">
      <label>Firebase Config Contents</label>
      <textarea class="fb-textarea" id="fb-paste-area" placeholder='apiKey: "AIzaSyXXXXXXXXX",
authDomain: "your-project.firebaseapp.com",
databaseURL: "https://your-project-default-rtdb.firebaseio.com",
projectId: "your-project",
storageBucket: "your-project.appspot.com",
messagingSenderId: "12345678",
appId: "1:12345678:web:abc123"'></textarea>
      <div class="fb-err" id="fb-err"></div>
    </div>
    <div class="fb-actions">
      <button class="btn-primary" onclick="submitFirebaseConfig()">Connect & Sync</button>
      <button class="btn-cancel" onclick="closeFirebaseModal()">Cancel</button>
    </div>
  </div>
</div>

</body>
</html>
